{{- range $ns := $.Values.namespaces }}
{{- if eq $.Values.quotaType "namespace" }}
---
apiVersion: v1
kind: ResourceQuota
metadata:
  name: resource-quota
  namespace: "{{ $.Values.name }}-{{ $ns.name }}"
spec:
  hard:
    {{- $resourceQuota := merge $.Values.namespaceResourceQuota $.Values.defaultOverallResourceQuota }}
    {{- $resourceQuota = merge ($ns.resourceQuota | default dict) $resourceQuota }}
    {{- nindent 4 ($resourceQuota | toYaml) }}

{{- end }}
{{- end }}