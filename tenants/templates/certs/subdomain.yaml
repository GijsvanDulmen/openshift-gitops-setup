{{- $namespaces := (include "tenants.namespaces" .) | fromYamlArray -}}
{{- range $ns := $namespaces }}
---
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: cloud-ticq-org
  namespace: "{{ $ns.namespaceName }}"
spec:
  commonName: "{{ $.Values.subdomain }}.cloud.ticq.org"
  dnsNames:
    - "{{ $.Values.subdomain }}.cloud.ticq.org"
    - "*.{{ $.Values.subdomain }}.cloud.ticq.org"
  secretName: subdomain-certs
  issuerRef:
    group: cert-manager.io
    name: letsencrypt-cluster-issuer-production
    kind: ClusterIssuer
{{- end }}
{{- end }}